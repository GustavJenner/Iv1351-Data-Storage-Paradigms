SELECT COUNT(instructor) AS number_of_lessons,instructor
FROM (SELECT lesson.instructor_id AS instructor, time_slot.date AS date
	FROM lesson
	INNER JOIN time_slot 
	on lesson.time_slot_id = time_slot.id 
	AND EXTRACT(MONTH FROM date) = (EXTRACT(MONTH FROM CURRENT_DATE))
	AND EXTRACT(YEAR FROM date) = EXTRACT(YEAR FROM CURRENT_DATE)) AS f
GROUP BY instructor
HAVING COUNT(instructor) > 6
ORDER BY number_of_lessons;
